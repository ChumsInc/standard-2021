<div data-section-id="{{ section.id }}"
     data-section-type="slideshow-section"
     data-align-top="true"
     {% if section.settings.parallax %}data-parallax="true"{% endif %}
     class="hero-slideshow">
    <!-- carousel section settings: {{ section.settings | json }} -->
    <!-- carousel section blocks: {{ section.blocks.size | json }} -->
    {% if section.blocks.size == 1 and section.settings.parallax %}
      {% assign block = section.blocks | first %}
      {% assign image_file_name = block.settings.image | replace_first: 'files/', '' %}
      {% assign img = images[image_file_name] %}
      {% assign img_width = img.width | append: 'x' %}
      <!-- img_width = {{ img_width | json }} -->
      <style>
        #parallax-{{ section.id }}.parallax-bg {
          background-image: url("{{ img.src |  img_url: '800x' }}");
          min-height: {{ 100 | divided_by: img.aspect_ratio }}vw;
          background-attachment: inherit;
          background-position: center;
          background-repeat: no-repeat;
          background-size: cover;
        }

        @media screen and (min-width: 800px) {
          #parallax-{{ section.id }}.parallax-bg {
            background-image: url("{{ img.src |  img_url: img_width }}");
          {% if section.settings.section_height %}
            min-height: {{ section.settings.section_height }};
          {% else %}
            min-height: {{ 50 | divided_by: img.aspect_ratio }}vw;
          {% endif %}
            background-attachment: fixed;
          }
        }
      </style>
        <div id="parallax-{{ section.id }}" class="parallax-bg"
             data-parallax-src="{{ img.src | img_url: '1x' }}"
             style="max-height: {{ 50 | divided_by: img.aspect_ratio }}vw">
            {% if block.settings.link %}<a href="{{ block.settings.link }}" style="height: 100%; display: block;">{% endif %}
            {% if block.settings.title or block.settings.subheading %}
                <div class="d-none d-md-block">
                    <h5>{{ block.settings.title }}</h5>
                    <p>{{ block.settings.subheading }}</p>
                </div>
            {% endif %}
            {% if block.settings.link %}</a>{% endif %}
        </div>
    {% elsif section.blocks.size > 0 %}
        {% assign max_aspect = 0 %}
        <div class="carousel slide" data-bs-ride="carousel" id="carousel-{{ section.id }}">
            {% if section.settings.style == 'bars' %}
                <div class="carousel-indicators">
                    {% for block in section.blocks %}
                        <button type="button" data-bs-target="#carousel-{{ section.id }}"
                                data-bs-slide-to="{{ forloop.index0 }}"
                                {% if forloop.index0 == 0 %}class="active" aria-current="true"{% endif %}
                                aria-label="Slide {{ forloop.index }}"></button>
                        <!-- carousel block settings: {{ block.settings | json }} -->
                        {% assign image_file_name = block.settings.image | replace_first: 'files/', '' %}
                        {% assign img = images[image_file_name] %}
                        <!-- img = {{ block.settings.image }}, {{ img.aspect_ratio | json }} -->
                        {% if img.aspect_ratio > max_aspect %}
                            {% assign max_aspect = img.aspect_ratio %}
                        {% endif %}
                    {% endfor %}
                </div>
            {% endif %}
            <div class="carousel-inner"
                    {% if section.settings.section_height != 'natural' %}
                        style="min-height: {{ section.settings.section_height }}"
                    {% elsif max_aspect > 0 %}
                        style="max-height: {{ 100 | divided_by: max_aspect }}vw"
                    {% endif %}>

                {% for block in section.blocks %}
                    {% assign img_size = '2000x' %}
                    {% if section.settings.section_height != 'natural' %}
                        {% assign img_size = section.settings.section_height | replace: 'px', 'x' %}
                    {% elsif section.settings.section_hight == '100vh' %}
                    {% endif %}
                    <div class="carousel-item {% if forloop.index0 == 0 %}active{% endif %}">
                        <a href="{% if block.settings.link %}{{ block.settings.link }}{% else %}#slide-{{ forloop.index0 }}{% endif %}">
                            <img srcset="{{ block.settings.image | img_url: '480x' }} 480w,
                         {{ block.settings.image | img_url: '800x' }} 800w,
                         {{ block.settings.image | img_url: '1200x' }} 1200w,
                         {{ block.settings.image | img_url: '2000x' }} 2000w"
                                 sizes="(max-width: 480px) 480px, (max-width: 800px) 800px, (max-width: 1200px) 1200px, 2000px"
                                 src="{{ block.settings.image | img_url: '2000x' }}" class="d-block w-100"
                                 alt="{{ block.settings.link }}" loading="lazy"/>
                            {% if block.settings.title or block.settings.subheading %}
                                <div class="carousel-caption d-none d-md-block">
                                    <h5>{{ block.settings.title }}</h5>
                                    <p>{{ block.settings.subheading }}</p>
                                </div>
                            {% endif %}
                        </a>
                    </div>
                {% endfor %}
            </div>
        </div>
    {% else %}
        <div class="placeholder-noblocks">
            {{ 'home_page.onboarding.no_content' | t }}
        </div>
    {% endif %}
</div>

{% schema %}
{
"name": "Slideshow",
"class": "index-section--hero",
"max_blocks": 5,
"settings": [
{
"type": "select",
"id": "section_height",
"label": "Desktop height",
"default": "650px",
"options": [
{
"label": "Natural",
"value": "natural"
},
{
"label": "450px",
"value": "450px"
},
{
"label": "550px",
"value": "550px"
},
{
"label": "650px",
"value": "650px"
},
{
"label": "750px",
"value": "750px"
},
{
"label": "Full screen",
"value": "100vh"
}
]
},
{
"type": "select",
"id": "mobile_height",
"label": "Mobile height",
"default": "auto",
"info": "Not used if desktop height is set to natural",
"options": [
{
"label": "Auto",
"value": "auto"
},
{
"label": "250px",
"value": "250px"
},
{
"label": "300px",
"value": "300px"
},
{
"label": "400px",
"value": "400px"
},
{
"label": "500px",
"value": "500px"
},
{
"label": "Full screen",
"value": "100vh"
}
]
},
{
"type": "checkbox",
"id": "parallax",
"label": "Enable parallax",
"default": true
},
{
"type": "select",
"id": "style",
"label": "Slide navigation style",
"default": "minimal",
"options": [
{
"value": "minimal",
"label": "Minimal"
},
{
"value": "arrows",
"label": "Arrows"
},
{
"value": "bars",
"label": "Bars"
},
{
"value": "dots",
"label": "Dots"
}
]
},
{
"type": "checkbox",
"id": "autoplay",
"label": "Auto-change slides",
"default": true
},
{
"type": "range",
"id": "autoplay_speed",
"label": "Change images every",
"default": 7,
"min": 5,
"max": 10,
"step": 1,
"unit": "s"
}
],
"blocks": [
{
"type": "image",
"name": "Slide",
"settings": [
{
"type": "text",
"id": "top_subheading",
"label": "Subheading"
},
{
"type": "textarea",
"id": "title",
"label": "Heading",
"default": "Two line\ntitle slide."
},
{
"type": "range",
"id": "title_size",
"label": "Heading text size",
"default": 80,
"min": 40,
"max": 100,
"unit": "px"
},
{
"type": "text",
"id": "subheading",
"label": "Text",
"default": "And optional subtext"
},
{
"type": "url",
"id": "link",
"label": "Slide link"
},
{
"type": "text",
"id": "link_text",
"label": "Slide link text",
"default": "Optional button"
},
{
"type": "url",
"id": "link_2",
"label": "Slide link 2"
},
{
"type": "text",
"id": "link_text_2",
"label": "Slide link text 2"
},
{
"type": "color",
"id": "color_accent",
"label": "Buttons",
"default": "rgba(0,0,0,0)"
},
{
"type": "select",
"id": "text_align",
"label": "Text alignment",
"default": "vertical-center horizontal-center",
"options": [
{
"value": "vertical-center horizontal-left",
"label": "Center left"
},
{
"value": "vertical-center horizontal-center",
"label": "Center"
},
{
"value": "vertical-center horizontal-right",
"label": "Center right"
},
{
"value": "vertical-bottom horizontal-left",
"label": "Bottom left"
},
{
"value": "vertical-bottom horizontal-center",
"label": "Bottom center"
},
{
"value": "vertical-bottom horizontal-right",
"label": "Bottom right"
}
]
},
{
"type": "image_picker",
"id": "image",
"label": "Image"
},
{
"type": "select",
"id": "focal_point",
"label": "Image focal point",
"info": "Used to keep the subject of your photo in view.",
"default": "center center",
"options": [
{
"value": "20% 0",
"label": "Top left"
},
{
"value": "top center",
"label": "Top center"
},
{
"value": "80% 0",
"label": "Top right"
},
{
"value": "20% 50%",
"label": "Left"
},
{
"value": "center center",
"label": "Center"
},
{
"value": "80% 50%",
"label": "Right"
},
{
"value": "20% 100%",
"label": "Bottom left"
},
{
"value": "bottom center",
"label": "Bottom center"
},
{
"value": "80% 100%",
"label": "Bottom right"
}
]
}
]
}
],
"presets": [{
"name": "Slideshow",
"category": "Image",
"settings": {
"autoplay": true,
"autoplay_speed": 5
},
"blocks": [
{
"type": "image",
"settings": {
"title": "Endless\npossibilities.",
"subheading": "Bring your brand to life"
}
},
{
"type": "image",
"settings": {
"title": "Two line\ntitle slide.",
"subheading": "And big, beautiful imagery"
}
}
]
}]
}
{% endschema %}
